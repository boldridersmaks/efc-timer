<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Stopwatch</title>
</head>
<body>
  <h1>Stopwatch</h1>
  <div id="timer">00:00</div>
  <button onclick="startTimer()">Start</button>
  <button onclick="pauseTimer()">Pause</button>
  <button onclick="stopTimer()">Stop</button>

  <script>
    let startTime, elapsed = 0, timerInterval;

    function updateTimer() {
      const now = Date.now();
      const diff = Math.floor((now - startTime + elapsed) / 1000);
      const minutes = String(Math.floor(diff / 60)).padStart(2, '0');
      const seconds = String(diff % 60).padStart(2, '0');
      document.getElementById('timer').textContent = `${minutes}:${seconds}`;
    }

    function startTimer() {
      startTime = Date.now();
      timerInterval = setInterval(updateTimer, 1000);
    }

    function pauseTimer() {
      clearInterval(timerInterval);
      elapsed += Date.now() - startTime;
    }

    function stopTimer() {
      clearInterval(timerInterval);
      const totalSeconds = Math.floor((Date.now() - startTime + elapsed) / 1000);
      const minutes = String(Math.floor(totalSeconds / 60)).padStart(2, '0');
      const seconds = String(totalSeconds % 60).padStart(2, '0');
      const formattedTime = `${minutes}:${seconds}`;

      // Kirim data ke Google Sheets via Web App
      fetch("https://script.google.com/macros/s/AKfycbwOdDwW7KBW9Ny67Mks3TgcRJzFlVO_PsQ-qxageOUwY8ncsdd2CV6hV7CzfIzzY9r-sA/exec", {
        method: "POST",
        body: JSON.stringify({
          action: "Stop",
          elapsedTime: formattedTime
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })
      .then(response => response.text())
      .then(data => alert("Timer stopped and sent: " + formattedTime))
      .catch(error => alert("Error: " + error));
    }
  </script>
</body>
</html>
